/*--------------------------MONTOS -------------------------------------*/

CREATE OR REPLACE TYPE MONTOS AS OBJECT (
	PRECIO FLOAT (10),
	CONV VARCHAR (10), /*B ES BOLIVARES, D ES DOLARES , E ES EUROS*/
	STATIC FUNCTION CONVERSION (MONTO NUMBER, MONEDAE NUMBER, MONEDAS NUMBER) RETURN NUMBER
);

CREATE OR REPLACE TYPE BODY MONTOS IS 
STATIC FUNCTION CONVERSION (MONTO NUMBER, MONEDAE NUMBER, MONEDAS NUMBER) RETURN NUMBER 
IS 
DOLAR NUMBER:= 33000;
EURO NUMBER:= 35000;
PRECIO NUMBER;
BEGIN 
	IF (MONEDAE = 1) THEN 
		IF (MONEDAS = 2) THEN 
			PRECIO := MONTO / DOLAR;
			RETURN PRECIO;
		ELSE 
			PRECIO := MONTO / EURO;
			RETURN PRECIO;
		END IF;

	ELSIF (MONEDAE = 2) THEN 
		IF (MONEDAS = 1) THEN 
				PRECIO := MONTO * DOLAR;
				RETURN PRECIO;
			ELSE 
				PRECIO := ((MONTO* DOLAR) / EURO);
				RETURN PRECIO;
			END IF;

	ELSIF (MONEDAE = 3) THEN 
		IF (MONEDAS = 1) THEN 
				PRECIO := MONTO * EURO;
				RETURN PRECIO;
			ELSE 
				PRECIO := ((MONTO* EURO) / DOLAR);
				RETURN PRECIO;
			END IF;  
    END IF; 
END;
END;

/*---------------------------DATOS BASICOS-----------------------------*/

CREATE OR REPLACE TYPE DATOS_BASICOS AS OBJECT (
	PRIMER_NOMBRE VARCHAR (25),
	SEGUNDO_NOMBRE VARCHAR (25),
	PRIMER_APELLIDO VARCHAR (25),
	SEGUNDO_APELLIDO VARCHAR (25),
	FECHA_NACIMIENTO DATE,
	STATIC FUNCTION CALCULAREDAD (FECHA_ACTUAL DATE, FECHA_NACIMIENTO DATE) RETURN NUMBER
);

CREATE OR REPLACE TYPE BODY DATOS_BASICOS IS 
	STATIC FUNCTION CALCULAREDAD (FECHA_ACTUAL DATE, FECHA_NACIMIENTO DATE) RETURN NUMBER
IS 
EDAD NUMBER(5);
BEGIN 
 	select (FECHA_ACTUAL- FECHA_NACIMIENTO)/365 as dateDiff INTO EDAD FROM DUAL ;
	RETURN EDAD;
END;
END;
/*---------------------------FECHAS-------------------------------------*/
CREATE OR REPLACE TYPE FECHAS AS OBJECT(
	FECHA_INICIO DATE,
	FECHA_FIN DATE,
	STATIC FUNCTION VALIDAR_FECHAS (FECHA_SALIDA DATE, FECHA_LLEGADA DATE) RETURN DATE
);


CREATE OR REPLACE TYPE BODY FECHAS IS 
	STATIC FUNCTION VALIDAR_FECHAS (FECHA_SALIDA DATE, FECHA_LLEGADA DATE) RETURN DATE
IS 
DIFERENCIA NUMBER(5);
FECHA DATE;
BEGIN 
	
	select trunc(to_date(FECHA_LLEGADA,'DD/MM/YY hh24:mi:ss')) - trunc(to_date(FECHA_SALIDA,'DD/MM/YY hh24:mi:ss'))AS diferencia_dias INTO DIFERENCIA from dual;
	IF (DIFERENCIA< 0 ) THEN 
		FECHA := to_date(FECHA_LLEGADA,'DD/MM/YY hh24:mi:ss')+(-(DIFERENCIA))+dbms_random.value(1,100);
	END IF;
	RETURN FECHA;
END;
END;


---------------------------------------- BLOBS-------------------------------

CREATE OR REPLACE DIRECTORY IMAGENES AS 'C:\FOTOS'; 
GRANT READ ON DIRECTORY IMAGENES TO SYS;



------------------------------------REINICIAR ID -----------------
ALTER TABLE FLOTA MODIFY (FLO_ID GENERATED AS IDENTITY (START WITH 1));